# MiniscopeAnalysisConcatenation

Miniscope Analysis Concatenation Package This package is a copy and modification of Guillaum Etter's Miniscope Analysis Package, with modifications allowing the ability to anaylse multiple recording sessions.

INSTALLATION:

Download or clone this repositor, and add its path to your list of active Matlab paths You need to download or clone the latest versions of CNMFE (https://github.com/zhoupc/CNMF_E) and NormCorre (https://github.com/flatironinstitute/NoRMCorre) and add them to your path. This is important as the MiniscopeAnalysis package relies on these two toolboxes OPTIONAL:

Analyse your miniscope data:
This package is most useful to those wishing to concatenate their recorded sessions, but is not recommended for sessions recorded weeks apart as miniscope shifts, and brain circuitry changes (CellReg would be a good option for these cases). In your "Current Folder" in MATLAB open the location containing all the recorded sessions you wish to analyse. It is important to note that MATLAB will go through every file with the names "behavCam","msCam", and "timestamp" in your folders. If there are folders you don't wish to anaylse make sure to take them out of this window. As well, this package is intended for miniscope users. Typically your folders will have been named like such: H10_M26_13, make sure yours are also in this format as this is how the script knows the order in which to concatenate. If you don't have any behavorial recordings remember to comment out the last part of "msRun2018_batch" as this will produce an error later when looking for those files.

PARAMETERS: -Downsampling: spatial downsampling is very important. It can really speed up your analysis but when done in excess can hinder you from finding cells. I would recommend a factor of 2 to start with, you can increase it up to 4 if your cells appear large and clear.

-isnonrigid: If set to 'true', will perform NormCorre non-rigid motion correction (can be slightly slower), if set to 'false', will perform classic rigid motion correction

-Downsampling: spatial downsampling is very important. It can really speed up your analysis but when done in excess can hinder you from finding cells. I would recommend a factor of 2 to start with, you can increase it up to 4 if your cells appear large and clear.

Save to google drive: I implemented this one because I love to have my desktop analyse data, and then shoot it to the cloud once it’s done so I could access it from anywhere (café, bar, family reunion, etc…) If set to 'true', it will ask you to provide a root path where all your data will be backed up. Note that it can also be a hard-drive, a USB key, etc… Sub-folders will be created using the name that you enter for each subject in the DAQ software. OUTPUT: Although this package tries to be as consistent as possible with previous versions of the ms package, there are a few changes here and there.

ms.Experiment: your experiment name, taken from the subject name that you enter in the DAQ software

ms.ds: the downsampling factor you used

ms.shifts: the full information about corrected motion generated by NormCorre

ms.Options: parameters used to perform CNMFE

ms.Centroids: Centroids used to initialize CNMFE. Please not these are not your final centroids (use SFPs to look at your actual spatial footprints and deduce centroids)

ms.SFPs: spatial footprints of the cells found while performing CNMFE extraction. You can plot them by typing: figure; imagesc(max(ms.SFPs,[],3));

ms.CorrProj: Correlation projection from the CNMFE. Displays which pixels are correlated together and suggests the location of your cells

ms.PeakToNoiseRatio: Peak-to-noise ratio of the correlation projection. Gives you an idea of most prominent cells in your recording.

ms.numSegments is now call ms.numNeurons (although not everyone performs calcium imaging in neurons... might be renamed in future releases)

In your behav structure, the background detected is now saved in the structure for plotting purposes later on: behav.background
